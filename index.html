<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ú–∞–≥–∞–∑–∏–Ω –ó–∞–≤–¥–∞–Ω—å</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- CSS STYLES --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            margin: 0;
            padding: 0;
            padding-bottom: 80px; /* –ú—ñ—Å—Ü–µ –¥–ª—è —Å–∫—Ä–æ–ª—É */
        }

        /* Header */
        .header {
            padding: 20px;
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 1px solid var(--tg-theme-hint-color, #ccc);
        }
        .coins-display {
            font-size: 18px;
            font-weight: bold;
            color: var(--tg-theme-button-color, #3390ec);
        }

        /* Tabs (Categories) */
        .tabs {
            display: flex;
            overflow-x: auto;
            padding: 10px;
            gap: 10px;
            background-color: var(--tg-theme-bg-color);
            scrollbar-width: none; /* –ü—Ä–∏—Ö–æ–≤–∞—Ç–∏ —Å–∫—Ä–æ–ª–±–∞—Ä */
        }
        .tab {
            padding: 8px 16px;
            border-radius: 20px;
            background-color: var(--tg-theme-secondary-bg-color, #eee);
            color: var(--tg-theme-text-color);
            font-size: 14px;
            white-space: nowrap;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid transparent;
        }
        .tab.active {
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #fff);
        }

        /* Task List */
        .task-list {
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Task Card */
        .task-card {
            background-color: var(--tg-theme-secondary-bg-color, #fff);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: opacity 0.3s;
        }
        
        .task-info h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
        }
        .task-info p {
            margin: 0;
            font-size: 13px;
            color: var(--tg-theme-hint-color, #888);
        }
        .coin-badge {
            display: inline-block;
            margin-top: 5px;
            font-size: 12px;
            font-weight: bold;
            color: #ff9f00;
        }

        /* Buttons */
        .btn-action {
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            min-width: 90px;
        }

        /* Completed State */
        .task-card.completed {
            opacity: 0.6;
            background-color: var(--tg-theme-bg-color);
            border: 1px solid var(--tg-theme-hint-color);
        }
        .task-card.completed .btn-action {
            background-color: transparent;
            color: var(--tg-theme-hint-color);
            cursor: default;
            border: 1px solid var(--tg-theme-hint-color);
        }

    </style>
</head>
<body>

    <div class="header">
        <div class="coins-display">üí∞ –ú–æ—ó –º–æ–Ω–µ—Ç–∏: <span id="userCoins">0</span></div>
        <div style="font-size: 12px; color: var(--tg-theme-hint-color); margin-top: 4px;">
            –í–∏–∫–æ–Ω—É–π –∑–∞–≤–¥–∞–Ω–Ω—è, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –±—ñ–ª—å—à–µ
        </div>
    </div>

    <div class="tabs" id="categoryTabs">
        </div>

    <div class="task-list" id="taskList">
        </div>

    <script>
        // --- 1. CONFIGURATION ---
        const tg = window.Telegram.WebApp;
        tg.expand(); // –†–æ–∑–≥–æ—Ä—Ç–∞—î–º–æ –Ω–∞ –≤–µ—Å—å –µ–∫—Ä–∞–Ω

        // --- 2. MOCK DATA (–¢—É—Ç –±—É–¥—É—Ç—å —Ç–≤–æ—ó 280 –∑–∞–≤–¥–∞–Ω—å) ---
        // –£ –º–∞–π–±—É—Ç–Ω—å–æ–º—É —Ü–µ –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—å —ñ–∑ Supabase
        const categories = ["–í—Å—ñ", "–°–ø–æ—Ä—Ç", "–ù–∞–≤—á–∞–Ω–Ω—è", "–°–æ—Ü–º–µ—Ä–µ–∂—ñ", "–ö—Ä–µ–∞—Ç–∏–≤"];
        
        const tasksData = [
            { id: 101, category: "–°–ø–æ—Ä—Ç", title: "100 –í—ñ–¥–∂–∏–º–∞–Ω—å", desc: "–ó–∞–ø–∏—à–∏ —Ç–∞–π–º–ª–∞–ø—Å", reward: 50 },
            { id: 102, category: "–°–ø–æ—Ä—Ç", title: "–ü—Ä–æ–±—ñ–∂–∫–∞ 5–∫–º", desc: "–°–∫—Ä—ñ–Ω —Ç—Ä–µ–∫–µ—Ä–∞", reward: 100 },
            { id: 201, category: "–ù–∞–≤—á–∞–Ω–Ω—è", title: "–ü—Ä–æ—á–∏—Ç–∞—Ç–∏ —Å—Ç–∞—Ç—Ç—é", desc: "–ù–∞–ø–∏—à–∏ –µ—Å–µ", reward: 30 },
            { id: 202, category: "–ù–∞–≤—á–∞–Ω–Ω—è", title: "–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞", desc: "–í—á–∏–º–æ 10 —Å–ª—ñ–≤", reward: 40 },
            { id: 301, category: "–°–æ—Ü–º–µ—Ä–µ–∂—ñ", title: "–†–µ–ø–æ—Å—Ç –≤ —Å—Ç–æ—Ä—ñ–∑", desc: "–í—ñ–¥–º—ñ—Ç—å –∞–∫–∞—É–Ω—Ç", reward: 20 },
            { id: 401, category: "–ö—Ä–µ–∞—Ç–∏–≤", title: "–ó–Ω—è—Ç–∏ TikTok", desc: "–ö—Ä–µ–∞—Ç–∏–≤–Ω–µ –≤—ñ–¥–µ–æ", reward: 150 },
            { id: 402, category: "–ö—Ä–µ–∞—Ç–∏–≤", title: "–ù–∞–º–∞–ª—é–≤–∞—Ç–∏ –ª–æ–≥–æ", desc: "–ù–∞ –ø–∞–ø–µ—Ä—ñ", reward: 80 },
        ];

        // --- 3. STATE MANAGEMENT (Local Storage for MVP) ---
        // –Ü–º—ñ—Ç—É—î–º–æ –±–∞–∑—É –¥–∞–Ω–∏—Ö –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å
        let completedTaskIds = JSON.parse(localStorage.getItem('completedTasks')) || [];
        let currentCategory = "–í—Å—ñ";

        // --- 4. RENDER FUNCTIONS ---
        
        function renderTabs() {
            const tabsContainer = document.getElementById('categoryTabs');
            tabsContainer.innerHTML = '';

            categories.forEach(cat => {
                const tab = document.createElement('div');
                tab.className = `tab ${cat === currentCategory ? 'active' : ''}`;
                tab.innerText = cat;
                tab.onclick = () => {
                    currentCategory = cat;
                    renderTabs(); // Re-render tabs to update active state
                    renderTasks(); // Re-render tasks
                };
                tabsContainer.appendChild(tab);
            });
        }

        function renderTasks() {
            const listContainer = document.getElementById('taskList');
            listContainer.innerHTML = '';

            // Filter tasks
            const filteredTasks = currentCategory === "–í—Å—ñ" 
                ? tasksData 
                : tasksData.filter(t => t.category === currentCategory);

            filteredTasks.forEach(task => {
                const isCompleted = completedTaskIds.includes(task.id);
                
                const card = document.createElement('div');
                card.className = `task-card ${isCompleted ? 'completed' : ''}`;

                card.innerHTML = `
                    <div class="task-info">
                        <h3>${task.title}</h3>
                        <p>${task.desc}</p>
                        <div class="coin-badge">+${task.reward} –º–æ–Ω–µ—Ç</div>
                    </div>
                    <button class="btn-action" onclick="handleTaskClick(${task.id})">
                        ${isCompleted ? '–ì–æ—Ç–æ–≤–æ' : '–í–∏–∫–æ–Ω–∞—Ç–∏'}
                    </button>
                `;
                listContainer.appendChild(card);
            });
        }

        // --- 5. INTERACTION LOGIC ---

        function handleTaskClick(taskId) {
            if (completedTaskIds.includes(taskId)) {
                return; // –ù—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç–∏, —è–∫—â–æ –≤–∂–µ –≤–∏–∫–æ–Ω–∞–Ω–æ
            }

            // 1. –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ª–æ–∫–∞–ª—å–Ω–æ, —â–æ —é–∑–µ—Ä "–≤–∑—è–≤" –∑–∞–≤–¥–∞–Ω–Ω—è
            // (–í —Ä–µ–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—ñ —Ç—É—Ç –±—É–¥–µ –∑–∞–ø–∏—Ç –¥–æ Supabase)
            /* –õ–æ–≥—ñ–∫–∞: –ú–∏ –ù–ï –ø–æ–∑–Ω–∞—á–∞—î–º–æ —è–∫ "–≤–∏–∫–æ–Ω–∞–Ω–æ" –æ–¥—Ä–∞–∑—É. 
               –ú–∏ –ø–µ—Ä–µ–∫–∏–¥–∞—î–º–æ –≤ –±–æ—Ç–∞. –ê–ª–µ –¥–ª—è –¥–µ–º–æ —è –¥–æ–¥–∞–º –≤ —Å–ø–∏—Å–æ–∫, 
               –Ω—ñ–±–∏ —é–∑–µ—Ä –π–æ–≥–æ –≤–∏–∫–æ–Ω–∞–≤.
            */
           
            // Deep Linking –¥–æ Telegram –ë–æ—Ç–∞
            // –§–æ—Ä–º–∞—Ç: https://t.me/YourBotName?start=task_101
            // SendPulse –º–∞—î –∑–ª–æ–≤–∏—Ç–∏ —Ç—Ä–∏–≥–µ—Ä "start" –∑—ñ –∑–º—ñ–Ω–Ω–æ—é
            
            const botUsername = "YOUR_BOT_USERNAME"; // –ó–ê–ú–Ü–ù–ò –ù–ê –Ü–ú'–Ø –°–í–û–ì–û –ë–û–¢–ê (–±–µ–∑ @)
            const payload = `task_${taskId}`; 
            const url = `https://t.me/${botUsername}?start=${payload}`;

            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –Ω–∞—Ç–∏–≤–Ω–∏–π –º–µ—Ç–æ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è —ñ –ø–µ—Ä–µ—Ö–æ–¥—É
            tg.openTelegramLink(url);
            
            // –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: –∑–∞–∫—Ä–∏—Ç–∏ WebApp –æ–¥—Ä–∞–∑—É
            tg.close();
        }

        // --- INITIALIZATION ---
        renderTabs();
        renderTasks();

    </script>
</body>
</html>